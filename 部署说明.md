# MoonTV ä¸€é”®éƒ¨ç½²åŒ…

## ğŸ“¦ åŒ…å«æ–‡ä»¶

- `docker-compose.yml` - Docker Compose é…ç½®æ–‡ä»¶
- `config.json` - MoonTV é…ç½®æ–‡ä»¶
- `start.bat` - Windows ä¸€é”®å¯åŠ¨è„šæœ¬
- `stop.bat` - Windows ä¸€é”®åœæ­¢è„šæœ¬
- `start.sh` - Linux/macOS ä¸€é”®å¯åŠ¨è„šæœ¬
- `stop.sh` - Linux/macOS ä¸€é”®åœæ­¢è„šæœ¬
- `éƒ¨ç½²è¯´æ˜.md` - æœ¬è¯´æ˜æ–‡æ¡£

## ğŸš€ å¿«é€Ÿå¼€å§‹

### Windows ç”¨æˆ·

1. **ç¡®ä¿å·²å®‰è£… Docker Desktop**
   - ä¸‹è½½åœ°å€ï¼šhttps://www.docker.com/products/docker-desktop
   - å®‰è£…åå¯åŠ¨ Docker Desktop

2. **ä¸€é”®å¯åŠ¨**
   ```cmd
   åŒå‡»è¿è¡Œ start.bat
   ```

3. **è®¿é—®æœåŠ¡**
   - æµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:3000
   - é»˜è®¤è´¦å·ï¼š`admin`
   - é»˜è®¤å¯†ç ï¼š`yezi`

4. **åœæ­¢æœåŠ¡**
   ```cmd
   åŒå‡»è¿è¡Œ stop.bat
   ```

### Linux/macOS ç”¨æˆ·

1. **ç¡®ä¿å·²å®‰è£… Docker å’Œ Docker Compose**
   ```bash
   # Ubuntu/Debian
   sudo apt update
   sudo apt install docker.io docker-compose
   
   # CentOS/RHEL
   sudo yum install docker docker-compose
   
   # macOS (ä½¿ç”¨ Homebrew)
   brew install docker docker-compose
   ```

2. **æ·»åŠ æ‰§è¡Œæƒé™**
   ```bash
   chmod +x start.sh stop.sh
   ```

3. **ä¸€é”®å¯åŠ¨**
   ```bash
   ./start.sh
   ```

4. **è®¿é—®æœåŠ¡**
   - æµè§ˆå™¨æ‰“å¼€ï¼šhttp://localhost:3000
   - é»˜è®¤è´¦å·ï¼š`admin`
   - é»˜è®¤å¯†ç ï¼š`yezi`

5. **åœæ­¢æœåŠ¡**
   ```bash
   ./stop.sh
   ```

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹å¯†ç 

ç¼–è¾‘ `docker-compose.yml` æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```yaml
environment:
  - USERNAME=ä½ çš„ç”¨æˆ·å
  - PASSWORD=ä½ çš„å¯†ç 
```

### ä¿®æ”¹ç«¯å£

ç¼–è¾‘ `docker-compose.yml` æ–‡ä»¶ï¼Œä¿®æ”¹ç«¯å£æ˜ å°„ï¼š

```yaml
ports:
  - '8080:3000'  # å°† 3000 æ”¹ä¸ºä½ æƒ³è¦çš„ç«¯å£
```

### ä¿®æ”¹èµ„æºç«™ç‚¹

ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œæ·»åŠ æˆ–åˆ é™¤èµ„æºç«™ç‚¹ã€‚

### å¼€å¯ç”¨æˆ·æ³¨å†Œ

ç¼–è¾‘ `docker-compose.yml` æ–‡ä»¶ï¼š

```yaml
environment:
  - NEXT_PUBLIC_ENABLE_REGISTER=true
```

## ğŸ”§ é«˜çº§é…ç½®

### æ•°æ®æŒä¹…åŒ–

é»˜è®¤é…ç½®å·²å¯ç”¨ Redis æ•°æ®æŒä¹…åŒ–ï¼Œæ•°æ®å­˜å‚¨åœ¨ Docker å·ä¸­ã€‚

### å¤‡ä»½æ•°æ®

```bash
# å¤‡ä»½ Redis æ•°æ®
docker exec moontv-redis redis-cli BGSAVE
docker cp moontv-redis:/data/dump.rdb ./backup-$(date +%Y%m%d).rdb
```

### æ¢å¤æ•°æ®

```bash
# åœæ­¢æœåŠ¡
docker-compose down

# æ¢å¤æ•°æ®
docker run --rm -v moontv_redis-data:/data -v $(pwd):/backup alpine cp /backup/dump.rdb /data/

# é‡å¯æœåŠ¡
docker-compose up -d
```

## ğŸŒ å¤–ç½‘è®¿é—®

### å±€åŸŸç½‘è®¿é—®

1. ç¡®ä¿é˜²ç«å¢™å…è®¸ 3000 ç«¯å£
2. ä½¿ç”¨æœåŠ¡å™¨ IP åœ°å€è®¿é—®ï¼š`http://æœåŠ¡å™¨IP:3000`

### å…¬ç½‘è®¿é—®ï¼ˆéœ€è¦åŸŸåï¼‰

1. **ä½¿ç”¨ Nginx åå‘ä»£ç†**

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

2. **ä½¿ç”¨ Cloudflare Tunnel**

```bash
# å®‰è£… cloudflared
curl -L --output cloudflared.deb https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb
sudo dpkg -i cloudflared.deb

# åˆ›å»ºéš§é“
cloudflared tunnel --url http://localhost:3000
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æŸ¥çœ‹ç«¯å£å ç”¨
   netstat -tulpn | grep 3000
   # æˆ–ä¿®æ”¹ docker-compose.yml ä¸­çš„ç«¯å£
   ```

2. **Docker æœåŠ¡æœªå¯åŠ¨**
   ```bash
   # Linux
   sudo systemctl start docker
   
   # Windows
   # å¯åŠ¨ Docker Desktop
   ```

3. **é•œåƒæ‹‰å–å¤±è´¥**
   ```bash
   # ä½¿ç”¨å›½å†…é•œåƒæº
   docker pull registry.cn-hangzhou.aliyuncs.com/senshinya/moontv:latest
   ```

4. **æœåŠ¡æ— æ³•è®¿é—®**
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   - ç¡®è®¤å®¹å™¨æ­£åœ¨è¿è¡Œï¼š`docker ps`
   - æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker logs moontv`

### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs moontv
docker-compose logs moontv-redis

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. æ“ä½œç³»ç»Ÿç‰ˆæœ¬
2. Docker ç‰ˆæœ¬ï¼š`docker --version`
3. é”™è¯¯æ—¥å¿—ï¼š`docker-compose logs`
4. å®¹å™¨çŠ¶æ€ï¼š`docker ps -a`

---

**äº«å— MoonTV å¸¦æ¥çš„è§‚å½±ä½“éªŒï¼** ğŸ¬